C51 COMPILER V9.01   MAIN                                                                  09/16/2024 23:06:33 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c OMF2 BROWSE DEBUG

line level    source

   1          #include"main.h"
   2          #include"..\lib\Soft_I2c.h"
   3          #include"..\lib\Lcd4.h"
   4          #include"..\lib\Rtc_Ds1307.h"
   5          #include"..\lib\LunarCalendar.h"
   6          #include"port.h"
   7          
   8          unsigned char * code Days[] = {"SUN","MON","TUE","WED","THU","FRI","SAT"};
   9          
  10          void main()
  11          {
  12   1              unsigned char Hour, Minute, Second, Mode, Day, Date, Month, Year;
  13   1              unsigned char SolarDate, SolarMonth;
  14   1              char SolarYear;
  15   1      
  16   1              Soft_I2c_Init();
  17   1              Ds1307_Init();
  18   1              Lcd_Init();
  19   1              Ds1307_Write(0x07, 0x90);
  20   1      
  21   1              //khoi tao Ngat canh xuong INT1
  22   1              IT1 = 1;
  23   1              EX1 = 1;
  24   1              EA = 1;
  25   1              while(1)
  26   1              {
  27   2                      Ds1307_Read_Time(&Hour, &Minute, &Second, &Mode);
  28   2      
  29   2                      Lcd_Chr(1,5,Hour/10+0x30);
  30   2                      Lcd_Chr_Cp(Hour%10+0x30);
  31   2                      Lcd_Chr_Cp(':');
  32   2                      Lcd_Chr_Cp(Minute/10+0x30);
  33   2                      Lcd_Chr_Cp(Minute%10+0x30);
  34   2                      Lcd_Chr_Cp(':');
  35   2                      Lcd_Chr_Cp(Second/10+0x30);
  36   2                      Lcd_Chr_Cp(Second%10+0x30);
  37   2      
  38   2                      Ds1307_Read_Date(&Day, &Date, &Month, &Year);
  39   2                      if(BTN == 1)
  40   2                      {
  41   3                              Lcd_Out(2,1,"                ");
  42   3                              Lcd_Out(2,2,Days[Day-1]);
  43   3                              Lcd_Chr_Cp(' ');
  44   3                              Lcd_Chr_Cp(Date/10+0x30);
  45   3                              Lcd_Chr_Cp(Date%10+0x30);
  46   3                              Lcd_Chr_Cp('/');
  47   3                              Lcd_Chr_Cp(Month/10+0x30);
  48   3                              Lcd_Chr_Cp(Month%10+0x30);
  49   3                              Lcd_Out_Cp("/20");
  50   3                              Lcd_Chr_Cp(Year/10+0x30);
  51   3                              Lcd_Chr_Cp(Year%10+0x30);
  52   3                      }
  53   2                      else
  54   2                      {
  55   3                              Solar2Lunar(Date, Month, Year, &SolarDate, &SolarMonth, & SolarYear);
C51 COMPILER V9.01   MAIN                                                                  09/16/2024 23:06:33 PAGE 2   

  56   3                              Lcd_Out(2,1,"LUNAR:");
  57   3                              Lcd_Chr_Cp(SolarDate/10+0x30);
  58   3                              Lcd_Chr_Cp(SolarDate%10+0x30);
  59   3                              Lcd_Chr_Cp('/');
  60   3                              Lcd_Chr_Cp(SolarMonth/10+0x30);
  61   3                              Lcd_Chr_Cp(SolarMonth%10+0x30);
  62   3                              Lcd_Chr_Cp('/');
  63   3                              Lcd_Chr_Cp((SolarYear+2000)/1000+0x30);
  64   3                              Lcd_Chr_Cp((SolarYear+2000)/100%10+0x30);
  65   3                              Lcd_Chr_Cp((SolarYear+2000)/10%10+0x30);
  66   3                              Lcd_Chr_Cp((SolarYear+2000)%10+0x30);
  67   3                      }
  68   2                      PCON |= 0x01; //trang thai nghi
  69   2              }
  70   1              
  71   1      }
  72          
  73          //ngat ngoai danh thuc he thong
  74          void EX1_ISR(void) interrupt 2
  75          {
  76   1      
  77   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    583    ----
   CONSTANT SIZE    =     77    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
